{"ast":null,"code":"import\"bootstrap/dist/css/bootstrap.min.css\";import React,{useState}from\"react\";// Importuj useState\nimport{useNavigate,useLocation}from\"react-router-dom\";// Importuj useNavigate\nimport\"bootstrap/dist/css/bootstrap.min.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PromenaLozinke=()=>{const[password,setPassword]=useState(\"\");const[password1,setPassword1]=useState(\"\");const[errorMessage,setErrorMessage]=useState(\"\");const[poljaError,setPoljaError]=useState(\"\");// Inicijalizacija navigate funkcije\nconst navigate=useNavigate();const location=useLocation();// Čitanje tokena iz URL query stringa, npr. /promena-lozinke?token=XYZ\nconst queryParams=new URLSearchParams(location.search);const resetToken=queryParams.get(\"token\");// Funkcija koja se poziva kada se forma pošalje\nconst handleSubmit=async e=>{e.preventDefault();// Sprečava podrazumevano ponašanje forme\n// Resetovanje grešaka\nsetErrorMessage(\"\");setPoljaError(\"\");if(!password||!password1){setPoljaError(\"Sva polja moraju biti popunjena.\");return;}if(password!==password1){setPoljaError(\"Lozinke se ne poklapaju.\");return;}// Ako nema tokena, ne možemo resetovati lozinku\nif(!resetToken){setErrorMessage(\"Token za resetovanje lozinke nije pronađen.\");return;}const userData={password:password,token:resetToken// prosleđujemo token backendu\n};try{// Slanje POST zahteva ka backendu\nconst response=await fetch(\"https://www.naruci.co.rs/auth/reset-password\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(userData)});if(response.ok){const data=await response.json();// Preusmeravanje korisnika na stranicu za naručivanje\nalert(\"Uspešno ste promenili lozinku, sada možete da se prijavite!\");navigate(\"/login\");}else{const data=await response.json();setErrorMessage(data.message||\"Došlo je do greške pri promeni lozinke.\");// Ako nije uspešno, postavi grešku\n}}catch(error){console.error(\"Greška prilikom slanja:\",error);setErrorMessage(\"Došlo je do greške pri slanju podataka.\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\" vh-100 d-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-5 d-none d-md-block\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-100 bg-white opacity-75\",style:{backgroundImage:\"url('/slike/login.jpg')\",backgroundSize:\"cover\",backgroundPosition:\"center\"}})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-7 d-flex align-items-center justify-content-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-70\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center fw-bold\",style:{color:\"#424242\",fontFamily:\"Montserrat\",fontSize:28},children:\"Promena lozinke\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-center mt-5\",style:{color:\"#9E9E9E\",fontFamily:\"Montserrat\",fontSize:18},children:\"_______________  nastavite  _______________\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-3 \",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",placeholder:\"Unesite va\\u0161u lozinku\",style:{fontFamily:\"Montserrat\",fontSize:14,height:41},value:password,onChange:e=>setPassword(e.target.value)})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 \",children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",placeholder:\"Potvrdite lozinku\",style:{fontFamily:\"Montserrat\",fontSize:14,height:41},value:password,onChange:e=>setPassword1(e.target.value)}),poljaError&&/*#__PURE__*/_jsx(\"div\",{className:\"text-danger\",children:poljaError})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn w-100 mb-5 fw-bold\",style:{backgroundColor:\"#486F5B\",color:\"white\",fontFamily:\"Montserrat\",fontSize:18},children:\"Promeni lozinku\"}),errorMessage&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-danger mt-3\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Gre\\u0161ka: \"}),\" \",errorMessage]})]})]})})]});};export default PromenaLozinke;","map":{"version":3,"names":["React","useState","useNavigate","useLocation","jsx","_jsx","jsxs","_jsxs","PromenaLozinke","password","setPassword","password1","setPassword1","errorMessage","setErrorMessage","poljaError","setPoljaError","navigate","location","queryParams","URLSearchParams","search","resetToken","get","handleSubmit","e","preventDefault","userData","token","response","fetch","method","headers","body","JSON","stringify","ok","data","json","alert","message","error","console","className","children","style","backgroundImage","backgroundSize","backgroundPosition","color","fontFamily","fontSize","onSubmit","type","placeholder","height","value","onChange","target","backgroundColor"],"sources":["D:/NARUCIVANJE-FE/src/pages/PromenaLozinke.js"],"sourcesContent":["import \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport React, { useState } from \"react\"; // Importuj useState\r\nimport { useNavigate, useLocation} from \"react-router-dom\"; // Importuj useNavigate\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\n\r\nconst PromenaLozinke = () => {\r\n\r\n    const [password, setPassword] = useState(\"\");\r\n    const [password1, setPassword1] = useState(\"\");\r\n    const [errorMessage, setErrorMessage] = useState(\"\");\r\n    const [poljaError, setPoljaError] = useState(\"\");\r\n\r\n    // Inicijalizacija navigate funkcije\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n\r\n    // Čitanje tokena iz URL query stringa, npr. /promena-lozinke?token=XYZ\r\n    const queryParams = new URLSearchParams(location.search);\r\n    const resetToken = queryParams.get(\"token\");\r\n\r\n    // Funkcija koja se poziva kada se forma pošalje\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault(); // Sprečava podrazumevano ponašanje forme\r\n\r\n\r\n        // Resetovanje grešaka\r\n        setErrorMessage(\"\");\r\n        setPoljaError(\"\");\r\n\r\n        if ( !password || !password1) {\r\n            setPoljaError(\"Sva polja moraju biti popunjena.\");\r\n            return;\r\n        }\r\n\r\n        if (password !== password1) {\r\n            setPoljaError(\"Lozinke se ne poklapaju.\");\r\n            return;\r\n        }\r\n\r\n        // Ako nema tokena, ne možemo resetovati lozinku\r\n        if (!resetToken) {\r\n            setErrorMessage(\"Token za resetovanje lozinke nije pronađen.\");\r\n            return;\r\n        } \r\n\r\n        const userData = {\r\n            password: password,\r\n            token: resetToken // prosleđujemo token backendu\r\n        };\r\n\r\n        try {\r\n            // Slanje POST zahteva ka backendu\r\n            const response = await fetch(\"https://www.naruci.co.rs/auth/reset-password\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\", },\r\n                body: JSON.stringify(userData),\r\n            });\r\n\r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                // Preusmeravanje korisnika na stranicu za naručivanje\r\n                alert(\"Uspešno ste promenili lozinku, sada možete da se prijavite!\");\r\n                navigate(\"/login\");\r\n            } else {\r\n                const data = await response.json();\r\n                setErrorMessage(data.message || \"Došlo je do greške pri promeni lozinke.\"); // Ako nije uspešno, postavi grešku\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Greška prilikom slanja:\", error);\r\n            setErrorMessage(\"Došlo je do greške pri slanju podataka.\");\r\n        }\r\n    };\r\n\r\n\r\n    return (\r\n        <div className=\" vh-100 d-flex\">\r\n            {/* Leva strana */}\r\n            <div className=\"col-md-5 d-none d-md-block\">\r\n                <div\r\n                    className=\"h-100 bg-white opacity-75\"\r\n                    style={{ backgroundImage: \"url('/slike/login.jpg')\", backgroundSize: \"cover\", backgroundPosition: \"center\" }}></div>\r\n            </div>\r\n\r\n            {/* Desna strana */}\r\n            <div className=\"col-md-7 d-flex align-items-center justify-content-center\">\r\n                <div className=\"w-70\">\r\n                    <h2 className=\"text-center fw-bold\" style={{ color: \"#424242\", fontFamily: \"Montserrat\", fontSize: 28 }}>Promena lozinke</h2>\r\n                    \r\n\r\n                    \r\n                    <p className=\"text-center mt-5\" style={{ color: \"#9E9E9E\", fontFamily: \"Montserrat\", fontSize: 18 }}>\r\n                        _______________  nastavite  _______________\r\n                    </p>\r\n\r\n                    <form onSubmit={handleSubmit}>\r\n                        <div className=\"mb-3 \">\r\n                            <input\r\n                                type=\"password\" className=\"form-control\" placeholder=\"Unesite vašu lozinku\"\r\n                                style={{ fontFamily: \"Montserrat\", fontSize: 14, height: 41 }}\r\n                                value={password}\r\n                                onChange={(e) => setPassword(e.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div className=\"mb-3 \">\r\n                            <input\r\n                                type=\"password\" className=\"form-control\" placeholder=\"Potvrdite lozinku\"\r\n                                style={{ fontFamily: \"Montserrat\", fontSize: 14, height: 41 }}\r\n                                value={password}\r\n                                onChange={(e) => setPassword1(e.target.value)}\r\n                            />\r\n                            {poljaError && <div className=\"text-danger\">{poljaError}</div>}\r\n                        </div>\r\n                        <button\r\n                            type=\"submit\"\r\n                            className=\"btn w-100 mb-5 fw-bold\"\r\n                            style={{ backgroundColor: \"#486F5B\", color: \"white\", fontFamily: \"Montserrat\", fontSize: 18 }}>\r\n                            Promeni lozinku\r\n                        </button>\r\n                        {errorMessage && (\r\n                            <div className=\"alert alert-danger mt-3\">\r\n                                <strong>Greška: </strong> {errorMessage}\r\n                            </div>\r\n                        )}\r\n                    </form>\r\n\r\n                    \r\n                </div>\r\n            </div>\r\n\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default PromenaLozinke;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}