{"ast":null,"code":"import\"bootstrap/dist/css/bootstrap.min.css\";import React,{useState}from\"react\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LoginPage=_ref=>{let{updateToken}=_ref;const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[errorMessage,setErrorMessage]=useState(\"\");const[poljaError,setPoljaError]=useState(\"\");const[emailError,setEmailError]=useState(\"\");const navigate=useNavigate();const emailRegex=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;const handleSubmit=async e=>{e.preventDefault();setEmailError(\"\");setErrorMessage(\"\");setPoljaError(\"\");if(!email.match(emailRegex)){setEmailError(\"Unesite validnu email adresu.\");return;}if(!email||!password){setPoljaError(\"Sva polja moraju biti popunjena.\");return;}try{const response=await fetch(\"https://www.naruci.co.rs/api/auth/login\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email,password})});const data=await response.json();if(response.ok){const token=data.accessToken;const role=data.role||\"ROLE_USER\";// OVO JE KLJUČNO – čistimo sve staro i čuvamo tačno ono što treba\nlocalStorage.clear();localStorage.setItem(\"token\",token);localStorage.setItem(\"role\",role);// ← OVO SMO DODALI\nupdateToken(token);// Odmah idemo gde treba\nif(role===\"ROLE_ADMIN\"){navigate(\"/admin\");}else{navigate(\"/meni\");}}else{setErrorMessage(data.message||\"Pogrešan email ili lozinka\");}}catch(error){setErrorMessage(\"Server nije dostupan\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"vh-100 d-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-5 d-none d-md-block\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-100 bg-white opacity-75\",style:{backgroundImage:\"url('/slike/login.jpg')\",backgroundSize:\"cover\",backgroundPosition:\"center\"}})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-7 d-flex align-items-center justify-content-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-70\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center fw-bold\",style:{color:\"#424242\",fontFamily:\"Montserrat\",fontSize:28},children:\"Dobrodo\\u0161li!\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-center fw-bold mt-5\",style:{color:\"#424242\",fontFamily:\"Montserrat\",fontSize:28},children:\"Prijavite se da naru\\u010Dite\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-center mt-5\",style:{color:\"#9E9E9E\",fontFamily:\"Montserrat\",fontSize:18},children:[\"Zaboravili ste lozinku?\",\" \",/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/lozinka\"),className:\"btn p-0 fw-bold\",style:{color:\"#486F5B\",fontFamily:\"Montserrat\",fontSize:18,background:\"none\",border:\"none\"},children:\"Promenite je ovde\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-center mt-3\",style:{color:\"#9E9E9E\",fontFamily:\"Montserrat\",fontSize:18},children:\"_______________  ili nastavite  _______________\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 mt-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",placeholder:\"Unesite va\\u0161 email\",style:{fontFamily:\"Montserrat\",fontSize:14,height:41},value:email,onChange:e=>setEmail(e.target.value)}),emailError&&/*#__PURE__*/_jsx(\"div\",{className:\"text-danger\",children:emailError})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",placeholder:\"Unesite va\\u0161u lozinku\",style:{fontFamily:\"Montserrat\",fontSize:14,height:41},value:password,onChange:e=>setPassword(e.target.value)}),poljaError&&/*#__PURE__*/_jsx(\"div\",{className:\"text-danger\",children:poljaError})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn w-100 mb-5 fw-bold\",style:{backgroundColor:\"#486F5B\",color:\"white\",fontFamily:\"Montserrat\",fontSize:18},children:\"Prijavi se\"}),errorMessage&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-danger mt-3\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Gre\\u0161ka: \"}),errorMessage]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/\"),className:\"btn w-100 p-0 fw-bold mt-5\",style:{color:\"#486F5B\",fontFamily:\"Montserrat\",fontSize:18,background:\"none\",border:\"none\"},children:\"\\u2190 Vrati se na po\\u010Detnu stranicu\"})]})})]});};export default LoginPage;","map":{"version":3,"names":["React","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","LoginPage","_ref","updateToken","email","setEmail","password","setPassword","errorMessage","setErrorMessage","poljaError","setPoljaError","emailError","setEmailError","navigate","emailRegex","handleSubmit","e","preventDefault","match","response","fetch","method","headers","body","JSON","stringify","data","json","ok","token","accessToken","role","localStorage","clear","setItem","message","error","className","children","style","backgroundImage","backgroundSize","backgroundPosition","color","fontFamily","fontSize","onClick","background","border","onSubmit","type","placeholder","height","value","onChange","target","backgroundColor"],"sources":["D:/NARUCIVANJE-FE/src/pages/LoginPage.js"],"sourcesContent":["import \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport React, { useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst LoginPage = ({ updateToken }) => {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [poljaError, setPoljaError] = useState(\"\");\r\n  const [emailError, setEmailError] = useState(\"\");\r\n\r\n  const navigate = useNavigate();\r\n  const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setEmailError(\"\");\r\n    setErrorMessage(\"\");\r\n    setPoljaError(\"\");\r\n\r\n    if (!email.match(emailRegex)) {\r\n      setEmailError(\"Unesite validnu email adresu.\");\r\n      return;\r\n    }\r\n    if (!email || !password) {\r\n      setPoljaError(\"Sva polja moraju biti popunjena.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(\"https://www.naruci.co.rs/api/auth/login\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ email, password }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (response.ok) {\r\n        const token = data.accessToken;\r\n        const role = data.role || \"ROLE_USER\";\r\n\r\n        // OVO JE KLJUČNO – čistimo sve staro i čuvamo tačno ono što treba\r\n        localStorage.clear();\r\n        localStorage.setItem(\"token\", token);\r\n        localStorage.setItem(\"role\", role);        // ← OVO SMO DODALI\r\n        updateToken(token);\r\n\r\n        // Odmah idemo gde treba\r\n        if (role === \"ROLE_ADMIN\") {\r\n          navigate(\"/admin\");\r\n        } else {\r\n          navigate(\"/meni\");\r\n        }\r\n      } else {\r\n        setErrorMessage(data.message || \"Pogrešan email ili lozinka\");\r\n      }\r\n    } catch (error) {\r\n      setErrorMessage(\"Server nije dostupan\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"vh-100 d-flex\">\r\n      <div className=\"col-md-5 d-none d-md-block\">\r\n        <div\r\n          className=\"h-100 bg-white opacity-75\"\r\n          style={{ backgroundImage: \"url('/slike/login.jpg')\", backgroundSize: \"cover\", backgroundPosition: \"center\" }}\r\n        ></div>\r\n      </div>\r\n\r\n      <div className=\"col-md-7 d-flex align-items-center justify-content-center\">\r\n        <div className=\"w-70\">\r\n          <h2 className=\"text-center fw-bold\" style={{ color: \"#424242\", fontFamily: \"Montserrat\", fontSize: 28 }}>Dobrodošli!</h2>\r\n          <h3 className=\"text-center fw-bold mt-5\" style={{ color: \"#424242\", fontFamily: \"Montserrat\", fontSize: 28 }}>Prijavite se da naručite</h3>\r\n\r\n          <p className=\"text-center mt-5\" style={{ color: \"#9E9E9E\", fontFamily: \"Montserrat\", fontSize: 18 }}>\r\n            Zaboravili ste lozinku?{\" \"}\r\n            <button onClick={() => navigate(\"/lozinka\")} className=\"btn p-0 fw-bold\" style={{ color: \"#486F5B\", fontFamily: \"Montserrat\", fontSize: 18, background: \"none\", border: \"none\" }}>\r\n              Promenite je ovde\r\n            </button>\r\n          </p>\r\n          <p className=\"text-center mt-3\" style={{ color: \"#9E9E9E\", fontFamily: \"Montserrat\", fontSize: 18 }}>\r\n            _______________  ili nastavite  _______________\r\n          </p>\r\n\r\n          <form onSubmit={handleSubmit}>\r\n            <div className=\"mb-3 mt-4\">\r\n              <input\r\n                type=\"email\"\r\n                className=\"form-control\"\r\n                placeholder=\"Unesite vaš email\"\r\n                style={{ fontFamily: \"Montserrat\", fontSize: 14, height: 41 }}\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n              />\r\n              {emailError && <div className=\"text-danger\">{emailError}</div>}\r\n            </div>\r\n            <div className=\"mb-3\">\r\n              <input\r\n                type=\"password\"\r\n                className=\"form-control\"\r\n                placeholder=\"Unesite vašu lozinku\"\r\n                style={{ fontFamily: \"Montserrat\", fontSize: 14, height: 41 }}\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n              />\r\n              {poljaError && <div className=\"text-danger\">{poljaError}</div>}\r\n            </div>\r\n            <button\r\n              type=\"submit\"\r\n              className=\"btn w-100 mb-5 fw-bold\"\r\n              style={{ backgroundColor: \"#486F5B\", color: \"white\", fontFamily: \"Montserrat\", fontSize: 18 }}\r\n            >\r\n              Prijavi se\r\n            </button>\r\n            {errorMessage && (\r\n              <div className=\"alert alert-danger mt-3\">\r\n                <strong>Greška: </strong>\r\n                {errorMessage}\r\n              </div>\r\n            )}\r\n          </form>\r\n\r\n          <button\r\n            onClick={() => navigate(\"/\")}\r\n            className=\"btn w-100 p-0 fw-bold mt-5\"\r\n            style={{ color: \"#486F5B\", fontFamily: \"Montserrat\", fontSize: 18, background: \"none\", border: \"none\" }}\r\n          >\r\n            ← Vrati se na početnu stranicu\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoginPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}