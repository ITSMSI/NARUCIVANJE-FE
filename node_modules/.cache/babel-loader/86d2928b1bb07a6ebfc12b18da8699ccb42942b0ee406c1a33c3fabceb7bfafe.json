{"ast":null,"code":"import React,{useState}from\"react\";import NavBar from\"../components/NavBar\";import Porudzbina from\"../components/Porudzbina\";import{jwtDecode}from\"jwt-decode\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PregledPage=()=>{const token=localStorage.getItem(\"token\");const decodedToken=token?jwtDecode(token):null;const[startDate,setStartDate]=useState(\"\");const[endDate,setEndDate]=useState(\"\");const[porudzbine,setPorudzbine]=useState([]);const[porudzDostupne,setPorudzDostupne]=useState(true);const[errorMsg,setErrorMsg]=useState(\"\");const handleDateChange=(e,type)=>{const newDate=e.target.value;if(type===\"start\"){setStartDate(newDate);setEndDate(\"\");// Resetujemo endDate ako menjamo start\n}else{const start=new Date(startDate);const end=new Date(newDate);const difference=(end-start)/(1000*60*60*24);// Razlika u danima\nif(difference>7){setErrorMsg(\"Možete pretraživati porudžbine u intervalu od maksimalno 7 dana.\");return;}setEndDate(newDate);setErrorMsg(\"\");// Brišemo grešku ako je sve ok\n}};const fetchPorudzbine=async()=>{if(!startDate||!endDate){alert(\"Molimo unesite oba datuma!\");return;}const formatDate=date=>new Date(date).toISOString().split(\"T\")[0];const formattedStartDate=formatDate(startDate);const formattedEndDate=formatDate(endDate);try{const response=await fetch(\"http://127.0.0.1:8080/api/v1/porudzbina/get/user/\".concat(decodedToken.id,\"/date-range?startDate=\").concat(formattedStartDate,\"&endDate=\").concat(formattedEndDate),{method:\"GET\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \".concat(token)}});if(response.status===404){setPorudzbine([]);setPorudzDostupne(false);}else if(!response.ok){throw new Error(\"Greška pri učitavanju porudžbina.\");}else{const result=await response.json();// 2. Sortiramo niz po datumu (pretpostavljam da je \"datum\" string koji se može parsirati)\nresult.sort((a,b)=>new Date(a.datum)-new Date(b.datum));const activeOrders=result.filter(porudzb=>porudzb.status===true);setPorudzbine(activeOrders);setPorudzDostupne(result.length>0);}}catch(error){console.error(\"Greška pri učitavanju porudžbina:\",error);setPorudzDostupne(false);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"container \",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-center fw-bold mt-5\",style:{fontFamily:\"Montserrat\",fontSize:16,color:\"#486F5B\"},children:\"Pregled porudzbina: \"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column align-items-center gap-3 w-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-center gap-3 w-50\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"form-control\",value:startDate,onChange:e=>handleDateChange(e,\"start\")}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"form-control\",min:startDate,max:startDate?new Date(new Date(startDate).getTime()+7*24*60*60*1000).toISOString().split(\"T\")[0]:\"\",value:endDate,onChange:e=>handleDateChange(e,\"end\"),disabled:!startDate})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn fw-bold mt-2\",style:{backgroundColor:\"#486F5B\",color:\"white\",fontFamily:\"Montserrat\",fontSize:14},onClick:fetchPorudzbine,children:\"Pretra\\u017Ei\"})]}),errorMsg&&/*#__PURE__*/_jsx(\"p\",{className:\"text-danger fw-bold text-center mt-3\",children:errorMsg}),!porudzDostupne?/*#__PURE__*/_jsx(\"p\",{className:\" text-danger fw-bold text-center\",style:{fontSize:\"30px\",fontFamily:\"Montserrat\",marginTop:100},children:\"Niste imali porudzbine u odabranom periodu.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"row mt-5\",children:porudzbine.map((p,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4 d-flex justify-content-center\",children:/*#__PURE__*/_jsx(Porudzbina,{porudzbina:p})},index))})]})]});};export default PregledPage;","map":{"version":3,"names":["React","useState","NavBar","Porudzbina","jwtDecode","jsx","_jsx","jsxs","_jsxs","PregledPage","token","localStorage","getItem","decodedToken","startDate","setStartDate","endDate","setEndDate","porudzbine","setPorudzbine","porudzDostupne","setPorudzDostupne","errorMsg","setErrorMsg","handleDateChange","e","type","newDate","target","value","start","Date","end","difference","fetchPorudzbine","alert","formatDate","date","toISOString","split","formattedStartDate","formattedEndDate","response","fetch","concat","id","method","headers","status","ok","Error","result","json","sort","a","b","datum","activeOrders","filter","porudzb","length","error","console","children","className","style","fontFamily","fontSize","color","onChange","min","max","getTime","disabled","backgroundColor","onClick","marginTop","map","p","index","porudzbina"],"sources":["D:/NARUCIVANJE-FE/src/pages/PregledPage.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport NavBar from \"../components/NavBar\";\r\nimport Porudzbina from \"../components/Porudzbina\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\n\r\nconst PregledPage = () => {\r\n    const token = localStorage.getItem(\"token\");\r\n    const decodedToken = token ? jwtDecode(token) : null;\r\n    const [startDate, setStartDate] = useState(\"\");\r\n    const [endDate, setEndDate] = useState(\"\");\r\n    const [porudzbine, setPorudzbine] = useState([]);\r\n    const [porudzDostupne, setPorudzDostupne] = useState(true);\r\n\r\n    const [errorMsg, setErrorMsg] = useState(\"\");\r\n\r\n    const handleDateChange = (e, type) => {\r\n        const newDate = e.target.value;\r\n\r\n        if (type === \"start\") {\r\n            setStartDate(newDate);\r\n            setEndDate(\"\"); // Resetujemo endDate ako menjamo start\r\n        } else {\r\n            const start = new Date(startDate);\r\n            const end = new Date(newDate);\r\n            const difference = (end - start) / (1000 * 60 * 60 * 24); // Razlika u danima\r\n\r\n            if (difference > 7) {\r\n                setErrorMsg(\"Možete pretraživati porudžbine u intervalu od maksimalno 7 dana.\");\r\n                return;\r\n            }\r\n\r\n            setEndDate(newDate);\r\n            setErrorMsg(\"\"); // Brišemo grešku ako je sve ok\r\n        }\r\n    };\r\n\r\n    const fetchPorudzbine = async () => {\r\n        if (!startDate || !endDate) {\r\n            alert(\"Molimo unesite oba datuma!\");\r\n            return;\r\n        }\r\n\r\n        const formatDate = (date) => new Date(date).toISOString().split(\"T\")[0];\r\n        const formattedStartDate = formatDate(startDate);\r\n        const formattedEndDate = formatDate(endDate);\r\n\r\n        try {\r\n            const response = await fetch(`http://127.0.0.1:8080/api/v1/porudzbina/get/user/${decodedToken.id}/date-range?startDate=${formattedStartDate}&endDate=${formattedEndDate}`, {\r\n                method: \"GET\",\r\n                headers: {\r\n                    \"Content-Type\": \"application/json\",\r\n                    \"Authorization\": `Bearer ${token}`\r\n                }\r\n            });\r\n\r\n            if (response.status === 404) {\r\n                setPorudzbine([]);\r\n                setPorudzDostupne(false);\r\n            } else if (!response.ok) {\r\n                throw new Error(\"Greška pri učitavanju porudžbina.\");\r\n            } else {\r\n                const result = await response.json();\r\n                // 2. Sortiramo niz po datumu (pretpostavljam da je \"datum\" string koji se može parsirati)\r\n                result.sort((a, b) => new Date(a.datum) - new Date(b.datum));\r\n                const activeOrders = result.filter(porudzb => porudzb.status === true);\r\n                setPorudzbine(activeOrders);\r\n                setPorudzDostupne(result.length > 0);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Greška pri učitavanju porudžbina:\", error);\r\n            setPorudzDostupne(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <NavBar />\r\n            <div className=\"container \">\r\n                <p className=\"text-center fw-bold mt-5\" style={{ fontFamily: \"Montserrat\", fontSize: 16, color: \"#486F5B\" }}>Pregled porudzbina: </p>\r\n                {/* Ovaj div centriramo u kolonu */}\r\n                <div className=\"d-flex flex-column align-items-center gap-3 w-100\">\r\n                    <div className=\"d-flex justify-content-center gap-3 w-50\">\r\n                        <input\r\n                            type=\"date\"\r\n                            className=\"form-control\"\r\n                            value={startDate}\r\n                            onChange={(e) => handleDateChange(e, \"start\")}\r\n                        />\r\n                        <input\r\n                            type=\"date\"\r\n                            className=\"form-control\"\r\n                            min={startDate}\r\n                            max={startDate ? new Date(new Date(startDate).getTime() + (7 * 24 * 60 * 60 * 1000)).toISOString().split(\"T\")[0] : \"\"}\r\n                            value={endDate}\r\n                            onChange={(e) => handleDateChange(e, \"end\")}\r\n                            disabled={!startDate}\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Dugme je sada ispod inputa i centrirano */}\r\n                    <button className=\"btn fw-bold mt-2\"\r\n                        style={{ backgroundColor: \"#486F5B\", color: \"white\", fontFamily: \"Montserrat\", fontSize: 14 }}\r\n                        onClick={fetchPorudzbine}>\r\n                        Pretraži\r\n                    </button>\r\n                </div>\r\n\r\n                {errorMsg && <p className=\"text-danger fw-bold text-center mt-3\">{errorMsg}</p>}\r\n\r\n                {!porudzDostupne ? (\r\n                    <p className=\" text-danger fw-bold text-center\" style={{ fontSize: \"30px\", fontFamily: \"Montserrat\", marginTop: 100 }}>\r\n                        Niste imali porudzbine u odabranom periodu.\r\n                    </p>\r\n                ) : (\r\n                    <div className=\"row mt-5\">\r\n                        {porudzbine.map((p, index) => (\r\n                            <div key={index} className=\"col-md-4 d-flex justify-content-center\">\r\n                                <Porudzbina porudzbina={p} />\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default PregledPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}